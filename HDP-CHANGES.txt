Changes only in Hortonworks github and not in Apache SPARK-2.3.1 and hence not covered by CHANGES.txt.

INCOMPATIBLE CHANGES

NEW FEATURES
    SPARK-13587: Support virtualenv in pyspark

    (Support Spark Atlas Connector)
    BUG-97790  Spark Atlas Connector: support Kafka as external data source
    BUG-92048 Implement loading and visualizing Spark ML pipeline abstracts at Atlas
    BUG-96831 Add commit protocol binding to Hadoop 3.1 PathOutputCommitter mechanism.

IMPROVEMENTS
    RMP-6461: Add --jarDirs and SPARK_APP_JARS to include directories in spark-submit and spark-shell
    RMP-6448: hdp.version
    RMP-6954: SparkSQL Ranger integration for fine grained access control in Spark 2.1
    BUG-70581 Add hadoop-3.0 profile
    RMP-9454: SparkSQL Ranger integration for fine grained access control in Spark 2.2
    BUG-97455 Update Spark to build against Kafka 1.0
    BUG-100381 Add Hive Metastore 3.0 support
    BUG-102958 Update HiveShim for Hive 3.0.0
    BUG-104039 Use official Hive 3.0.0 metastore library
    BUG-100279 Add adl & wasb not loading
    BUG-104421 Try HDP fallback paths for Hive jars

BUG FIXES
    BUG-58486   Use cache file created by ambari as spark.yarn.archive
    BUG-48982   Add hadoop lzo jar to the classpath
    BUG-52253   Support configuring YARN correctly for multiple Spark versions and their aux-services
    BUG-60289   Spark2 jersey and Timeline Jersey are incompatible
    BUG-59418   changes to KafkaRDD MessageAndMetadata to use named params
    BUG-63858   S3CountLines application fails in yarn-cluster mode: user should not call system.exit(0) terminate the application in spark 2
    BUG-68592   Implement `spark-llap2` package for Spark 2.1.x
    SPARK-207   Remove hardcode FS scheme from Spark archive
    BUG-77149   Spark2 build failure in atlantic because [SPARK-17979] SPARK_YARN_USER_ENV and SPARK_JAVA_OPTS depreciated.
    BUG-77776   Fix STS error handling logic on HiveSQLException
    BUG-81926   Issue with inserting data from Spark SQL using hivecontext
    BUG-77400   Fix HiveServer2 delegation token acquisition
    BUG-84597   Fix VersionsSuite failures
    BUG-86685   Fix SparkLauncherSuite.testChildProcLauncher
    BUG-86834   Add missing import package name in HiveServer2CredentialProvider
    BUG-90803   Added hadoop-azure-datalake and azure-data-lake-store-sdk to all the wasb locations
    BUG-95434   Fix connection string to use `isRunningInYarnContainer`
    BUG-99560   Enable `kafka-0-8` build in atlantic by using Kafka `0.10.1.2.6.4.0-91`
    BUG-101806  Remove explicit adl sdk import from Spark build, and use hadoop transitive dependency instead.
    BUG-101699  Update HDP Spark to match hadoop3 profile with Apache
    BUG-103907  IsolatedClientLoader should receive Apache Hadoop version
    BUG-104322  Use cache file created by ambari as spark.sql.hive.metastore.jars
    BUG-98248   Add configuration2 dependency into shared classes to avoid failures in `HiveClientImpl.runHive`

    (Backport from 2.3.2)
    SPARK-24455 fix typo in TaskSchedulerImpl comment
    SPARK-24369 Correct handling for multiple distinct aggregations having the same argument set
    SPARK-24468 Handle negative scale when adjusting precision for decimal operations
    SPARK-23732 Fix source links in generated scaladoc
    SPARK-24502 flaky test: UnsafeRowSerializerSuite
    SPARK-24531 Remove version 2.2.0 from testing versions in HiveExternalCatalogVersionsSuite
    SPARK-24506 Add UI filters to tabs added after binding
    SPARK-23754 Move UDF stop iteration wrapping from driver to executor
    MINOR       Remove unnecessary sort in UnsafeInMemorySorterSuite
    MINOR       Fix typo in serializer exception
    Revert SPARK-21743 top-most limit should not cause memory leak
    SPARK-24531 Replace 2.3.0 version with 2.3.1
    SPARK-24495 EnsureRequirement returns wrong plan when reordering equal keys

    (Backport from 2.4)
    SPARK-21783 Turn on `native` ORC impl and PPD by default
    SPARK-23456 Turn on `native` ORC impl and PPD by default
    SPARK-23228 Add Python Created jsparkSession to JVM's defaultSession
    SPARK-23510 Support Hive 2.2 and Hive 2.3 metastore
    SPARK-23518 Avoid metastore access when the users only want to read and write data frames
    SPARK-23635 Spark executor env variable is overwritten by same name AM env variable
    SPARK-23787 Fix file download test in SparkSubmitSuite for Hadoop 2.9.
    SPARK-23355 convertMetastore should not ignore table properties
    SPARK-24110 Avoid UGI.loginUserFromKeytab in STS
    SPARK-24149 Retrieve all federated namespaces tokens
    SPARK-24209 Automatic retrieve proxyBase from Knox headers
    SPARK-24312 Upgrade to 2.3.3 for Hive Metastore Client 2.3
    SPARK-24377 make --py-files work in non pyspark application
    SPARK-24479 Added config for registering streamingQueryListeners
    SPARK-24518 Using Hadoop credential provider API to store password
    SPARK-24660 Show correct error pages when downloading logs in SHS

    (Jira in Apache Spark is IN PROGRESS)
    SPARK-23977 Add commit protocol binding to Hadoop 3.1 PathOutputCommitter mechanism
  SPARK-24613   Cache with UDF could not be matched with subsequent dependent caches
  SPARK-24891   Fix HandleNullInputsForUDF rule
  SPARK-24891   Fix the Compilation Errors

[BUG-123861][SPARK-23966][SS] Refactoring all checkpoint file writing logic in a common CheckpointFileManager interface
[BUG-123861][SPARK-24485][SS] Measure and log elapsed time for filesystem operations in HDFSBackedStateStoreProvider
